"use strict";

var _require = require("./util/string");

var interpolate = _require.interpolate;

var _require2 = require("./transforms");

var general = _require2.general;

var endpoints = require("./sport-vu-endpoints");
var getJson = require("./get-json");

function getTransform(endpoint) {
  return general;
}

function makeSportVuMethod(endpoint, transport) {
  var makeUrl = interpolate(endpoint.url);
  var transform = getTransform(endpoint);

  function sportVuMethod() {
    var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

    options = Object.assign({}, endpoint.defaults, options);
    return transport(makeUrl(options), {}).then(transform);
  }

  sportVuMethod.defaults = endpoint.defaults;
  sportVuMethod.params = endpoint.params ? endpoint.params : Object.keys(endpoint.defaults);

  return sportVuMethod;
}

function makeSportVuClient(transport) {
  var client = {};
  endpoints.forEach(function (endpoint) {
    client[endpoint.name] = makeSportVuMethod(endpoint, transport);
  });
  client.withTransport = makeSportVuClient;
  return client;
}

module.exports = makeSportVuClient(getJson);